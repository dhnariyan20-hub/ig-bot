const { IgApiClient } = require("instagram-private-api");
const fs = require("fs");

const ig = new IgApiClient();

const USERNAME = "maverickzaypher";
const PASSWORD = "jimjim1234";

(async () => {
  try {
    ig.state.generateDevice(USERNAME);

    // session reuse (safe)
    if (fs.existsSync("session.json")) {
      await ig.state.deserialize(JSON.parse(fs.readFileSync("session.json")));
      console.log("ğŸ” Session loaded");
    } else {
      await ig.account.login(USERNAME, PASSWORD);
      fs.writeFileSync(
        "session.json",
        JSON.stringify(await ig.state.serialize())
      );
      console.log("ğŸ” Logged in & session saved");
    }

    // ğŸ” simple test call
    const me = await ig.account.currentUser();
    console.log("âœ… LOGIN SUCCESS");
    console.log("ğŸ‘¤ Username:", me.username);
    console.log("ğŸ†” UserID:", me.pk);

  } catch (e) {
    console.log("âŒ LOGIN FAILED");
    console.log(e.message);
  }
})();